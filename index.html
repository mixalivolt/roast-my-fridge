<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roast My Fridge ‚Äî Upload any image and let AI roast it</title>
  <meta name="description" content="Upload any image. AI will roast it. Simple as that.">
  <meta property="og:title" content="Roast My Fridge">
  <meta property="og:description" content="Upload any image and let AI roast it.">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Roast My Fridge">
  <meta name="twitter:description" content="Upload any image and let AI roast it.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Source+Sans+3:wght@400;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Source Sans 3', -apple-system, sans-serif;
      background: #FFFFFF;
      color: #202122;
      min-height: 100vh;
      border-top: 3px solid #1a1a1a;
    }

    .container {
      max-width: 640px;
      margin: 0 auto;
      padding: 40px 24px 80px;
    }

    .header {
      border-bottom: 1px solid #a2a9b1;
      padding-bottom: 8px;
      margin-bottom: 24px;
    }

    .logo-link { text-decoration: none; color: inherit; }

    .logo {
      font-family: 'Libre Baskerville', Georgia, serif;
      font-size: 2rem;
      font-weight: 700;
      color: #000;
    }

    .tagline {
      font-size: 0.95rem;
      color: #54595d;
      margin-top: 4px;
      font-style: italic;
    }

    .disclaimer {
      font-size: 0.75rem;
      color: #72777d;
      margin-top: 8px;
      padding: 8px 12px;
      background: #f8f9fa;
      border: 1px solid #eaecf0;
      border-radius: 2px;
      line-height: 1.5;
    }

    .section-heading {
      font-family: 'Libre Baskerville', Georgia, serif;
      font-size: 1.15rem;
      font-weight: 400;
      color: #000;
      border-bottom: 1px solid #a2a9b1;
      padding-bottom: 4px;
      margin-top: 28px;
      margin-bottom: 16px;
    }

    .upload-zone {
      width: 100%;
      border: 1px dashed #a2a9b1;
      border-radius: 2px;
      padding: 40px 24px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #f8f9fa;
    }

    .upload-zone:hover { border-color: #36c; background: #eaf3ff; }
    .upload-zone.dragover { border-color: #36c; background: #eaf3ff; }
    .upload-zone.has-image { padding: 12px; background: #f8f9fa; }

    .upload-icon { font-size: 2.5rem; margin-bottom: 8px; display: block; }
    .upload-text { font-size: 0.95rem; color: #202122; }
    .upload-subtext { font-size: 0.82rem; color: #72777d; margin-top: 4px; }
    .upload-zone input[type="file"] { display: none; }

    .preview-img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 2px;
      object-fit: cover;
      border: 1px solid #c8ccd1;
    }

    .change-photo {
      display: inline-block;
      margin-top: 8px;
      font-size: 0.82rem;
      color: #36c;
      cursor: pointer;
    }
    .change-photo:hover { text-decoration: underline; }

    .roast-btn {
      width: 100%;
      margin-top: 16px;
      padding: 14px 24px;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      color: #fff;
      background: #1a1a1a;
      border: none;
      border-radius: 2px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .roast-btn:hover { background: #333; }
    .roast-btn:disabled { opacity: 0.35; cursor: not-allowed; }

    .loading-state {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      margin-top: 32px;
      width: 100%;
    }
    .loading-state.active { display: flex; }

    .loader {
      width: 28px; height: 28px;
      border: 3px solid #eaecf0;
      border-top: 3px solid #1a1a1a;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-text {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.82rem;
      color: #54595d;
    }

    .result-card { display: none; width: 100%; margin-top: 28px; }
    .result-card.active { display: block; animation: fadeIn 0.4s ease both; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result-box {
      border: 1px solid #a2a9b1;
      border-radius: 2px;
      background: #fff;
    }

    .result-header {
      background: #f8f9fa;
      border-bottom: 1px solid #a2a9b1;
      padding: 10px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .result-header-title {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.78rem;
      font-weight: 500;
      color: #54595d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .result-body { padding: 20px; }

    .personality-badge {
      display: inline-block;
      padding: 4px 12px;
      background: #eaf3ff;
      border: 1px solid #a7d0ff;
      border-radius: 2px;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.85rem;
      font-weight: 500;
      color: #36c;
      margin-bottom: 16px;
    }

    .roast-text {
      font-family: 'Libre Baskerville', Georgia, serif;
      font-size: 1.05rem;
      line-height: 1.7;
      color: #202122;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid #eaecf0;
    }

    .forecast-section {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 12px;
      background: #f8f9fa;
      border: 1px solid #eaecf0;
      border-radius: 2px;
    }

    .forecast-icon { font-size: 1.1rem; flex-shrink: 0; margin-top: 2px; }
    .forecast-label {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 0.7rem;
      color: #72777d;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 2px;
    }
    .forecast-text { font-size: 0.9rem; color: #54595d; line-height: 1.5; }

    .share-section {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #eaecf0;
    }
    .share-label { font-size: 0.78rem; color: #72777d; margin-bottom: 10px; }

    .share-buttons { display: flex; gap: 8px; flex-wrap: wrap; }

    .share-btn {
      padding: 8px 14px;
      border-radius: 2px;
      border: 1px solid #a2a9b1;
      background: #f8f9fa;
      color: #36c;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.15s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .share-btn:hover { background: #eaf3ff; border-color: #a7d0ff; }

    .try-again-btn {
      margin-top: 16px;
      padding: 14px 24px;
      background: #1a1a1a;
      border: none;
      border-radius: 2px;
      color: white;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
    }
    .try-again-btn:hover { background: #333; }

    .counter { margin-top: 32px; font-size: 0.78rem; color: #a2a9b1; }
    .counter span { color: #54595d; font-weight: 600; }

    .footer {
      margin-top: 40px;
      padding-top: 16px;
      border-top: 1px solid #eaecf0;
      font-size: 0.75rem;
      color: #a2a9b1;
    }
    .footer a { color: #36c; text-decoration: none; }
    .footer a:hover { text-decoration: underline; }

    @media (max-width: 480px) {
      .logo { font-size: 1.6rem; }
      .container { padding: 28px 16px 60px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="/" class="logo-link" id="logoLink"><h1 class="logo">Roast My Fridge</h1></a>
      <p class="tagline">Upload any image and let AI roast it.</p>
      <div class="disclaimer">‚ö†Ô∏è This tool uses artificial intelligence to generate humorous commentary about uploaded images. Results are algorithmically generated and should not be taken personally. Side effects may include involuntary laughter, existential reflection, and the urge to clean your fridge.</div>
    </div>

    <h2 class="section-heading">Submit image for analysis</h2>

    <div class="upload-zone" id="uploadZone">
      <span class="upload-icon">üìé</span>
      <p class="upload-text">Choose file or drag here</p>
      <p class="upload-subtext">Accepts fridges, selfies, closets, desks, pets, and poor life decisions</p>
      <input type="file" id="fileInput" accept="image/*">
    </div>

    <button class="roast-btn" id="roastBtn" disabled>Submit for Roasting</button>

    <div class="loading-state" id="loadingState">
      <div class="loader"></div>
      <p class="loading-text" id="loadingText">Processing image...</p>
    </div>

    <div class="result-card" id="resultCard">
      <div class="result-box">
        <div class="result-header">
          <span class="result-header-title">Official Roast Report</span>
          <span style="font-size: 0.75rem; color: #72777d;">Case #<span id="caseNumber">00000</span></span>
        </div>
        <div class="result-body">
          <div class="personality-badge" id="personalityBadge"></div>

          <div class="roast-text" id="roastText"></div>

          <div class="forecast-section">
            <span class="forecast-icon" id="forecastIcon">üí∞</span>
            <div>
              <div class="forecast-label" id="forecastLabel">Financial Forecast</div>
              <div class="forecast-text" id="forecastText"></div>
            </div>
          </div>

          <div class="share-section">
            <p class="share-label">Distribute findings:</p>
            <div class="share-buttons">
              <a class="share-btn" id="shareTwitter" href="#" target="_blank">ùïè Post</a>
              <button class="share-btn" id="shareCopy">üìã Copy</button>
              <button class="share-btn" id="shareNative">üì§ Share</button>
            </div>
          </div>
        </div>
      </div>

      <button class="try-again-btn" id="tryAgainBtn">Submit Another Image</button>
    </div>

    <div class="counter" id="counter">
      <span id="roastCount">0</span> images analyzed to date
    </div>

    <div class="footer">
      <a href="https://roastmyfridge.lol">roastmyfridge.lol</a> ¬∑ est. 2026 ¬∑ powered by questionable AI
    </div>
  </div>

  <script>
    let imageData = null;
    let imageMediaType = null;
    let currentResult = null;

    const uploadZone = document.getElementById('uploadZone');
    const fileInput = document.getElementById('fileInput');
    const roastBtn = document.getElementById('roastBtn');
    const loadingState = document.getElementById('loadingState');
    const loadingText = document.getElementById('loadingText');
    const resultCard = document.getElementById('resultCard');

    const loadingMessages = [
      "Processing image...",
      "Running diagnostics...",
      "Consulting the algorithm...",
      "Cross-referencing database of poor choices...",
      "Calibrating savagery...",
      "Reviewing evidence...",
      "Compiling report...",
      "This is going to hurt...",
    ];

    let roastCount = parseInt(sessionStorage.getItem('roastCount')) || 14847;
    document.getElementById('roastCount').textContent = roastCount.toLocaleString();

    document.getElementById('logoLink').addEventListener('click', (e) => {
      e.preventDefault();
      window.location.href = '/';
    });

    uploadZone.addEventListener('click', () => fileInput.click());

    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('dragover');
    });

    uploadZone.addEventListener('dragleave', () => {
      uploadZone.classList.remove('dragover');
    });

    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('image/')) handleFile(file);
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) handleFile(file);
    });

    function handleFile(file) {
      uploadZone.classList.add('has-image');
      uploadZone.innerHTML = '<p class="upload-text">Processing photo...</p>';

      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          const MAX = 600;
          let w = img.width, h = img.height;
          if (w > h) { if (w > MAX) { h = h * MAX / w; w = MAX; } }
          else { if (h > MAX) { w = w * MAX / h; h = MAX; } }

          const canvas = document.createElement('canvas');
          canvas.width = w;
          canvas.height = h;
          canvas.getContext('2d').drawImage(img, 0, 0, w, h);

          const compressed = canvas.toDataURL('image/jpeg', 0.6);
          imageData = compressed.split(',')[1];
          imageMediaType = 'image/jpeg';

          uploadZone.innerHTML = `
            <img src="${compressed}" class="preview-img" alt="Upload">
            <span class="change-photo">change image</span>
            <input type="file" id="fileInput" accept="image/*" style="display:none">
          `;

          const newInput = uploadZone.querySelector('input[type="file"]');
          uploadZone.addEventListener('click', () => newInput.click());
          newInput.addEventListener('change', (ev) => {
            const f = ev.target.files[0];
            if (f) handleFile(f);
          });

          roastBtn.disabled = false;
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    roastBtn.addEventListener('click', async () => {
      if (!imageData) return;

      roastBtn.style.display = 'none';
      resultCard.classList.remove('active');
      loadingState.classList.add('active');

      let msgIndex = 0;
      const msgInterval = setInterval(() => {
        msgIndex = (msgIndex + 1) % loadingMessages.length;
        loadingText.textContent = loadingMessages[msgIndex];
      }, 2000);

      try {
        const res = await fetch('/api/roast', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ image: imageData, mediaType: imageMediaType }),
        });

        if (!res.ok) throw new Error('Roast failed');
        const data = await res.json();
        if (data.error) throw new Error(data.error);

        currentResult = data;
        displayResult(data);

        roastCount += 1;
        sessionStorage.setItem('roastCount', roastCount);
        document.getElementById('roastCount').textContent = roastCount.toLocaleString();
      } catch (err) {
        alert('Analysis failed. Please try again.');
        console.error(err);
        roastBtn.style.display = 'block';
      } finally {
        clearInterval(msgInterval);
        loadingState.classList.remove('active');
      }
    });

    function displayResult(data) {
      document.getElementById('personalityBadge').textContent = data.personality || 'Unclassified';
      document.getElementById('roastText').innerHTML = (data.roast || 'No comment.');
      document.getElementById('forecastIcon').textContent = data.forecast_icon || 'üí∞';
      document.getElementById('forecastLabel').textContent = data.forecast_label || 'Financial Forecast';
      document.getElementById('forecastText').textContent = data.forecast || 'Insufficient data.';
      document.getElementById('caseNumber').textContent = String(Math.floor(Math.random() * 99999)).padStart(5, '0');

      resultCard.classList.add('active');
      resultCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function getShareText() {
      if (!currentResult) return '';
      return `AI classified me as "${currentResult.personality}" üíÄ\n\n${currentResult.roast}\n\nGet your report ‚Üí ${window.location.href}`;
    }

    document.getElementById('shareTwitter').addEventListener('click', (e) => {
      e.preventDefault();
      const text = `AI classified me as "${currentResult?.personality || ''}" üíÄ\n\nGet your report ‚Üí`;
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(window.location.href)}`, '_blank');
    });

    document.getElementById('shareCopy').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(getShareText());
        const btn = document.getElementById('shareCopy');
        btn.textContent = '‚úÖ Copied!';
        setTimeout(() => btn.textContent = 'üìã Copy', 2000);
      } catch {
        const ta = document.createElement('textarea');
        ta.value = getShareText();
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
      }
    });

    document.getElementById('shareNative').addEventListener('click', async () => {
      if (navigator.share) {
        try { await navigator.share({ title: 'Roast My Fridge', text: getShareText(), url: window.location.href }); } catch {}
      } else { document.getElementById('shareCopy').click(); }
    });

    document.getElementById('tryAgainBtn').addEventListener('click', () => {
      window.location.href = '/';
    });
  </script>
</body>
</html>
