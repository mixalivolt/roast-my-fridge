<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roast My Fridge üî• ‚Äî AI judges your fridge and your life choices | roastmyfridge.lol</title>
  <meta name="description" content="Upload a photo of your fridge. AI will roast your entire existence based on what's inside. Share your score with friends.">
  <meta property="og:title" content="Roast My Fridge üî•">
  <meta property="og:description" content="Upload a photo of your fridge. AI will destroy you based on what's inside.">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Roast My Fridge üî•">
  <meta name="twitter:description" content="Upload a photo of your fridge. AI will destroy you based on what's inside.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --fire: #FF4D00;
      --ember: #FF8A00;
      --lava: #FF2D2D;
      --ash: #1A1A1A;
      --smoke: #2A2A2A;
      --charcoal: #0D0D0D;
      --cool: #B0B0B0;
      --ice: #E8E8E8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--charcoal);
      color: var(--ice);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* FIRE BACKGROUND EFFECT */
    body::before {
      content: '';
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: 
        radial-gradient(ellipse at 20% 50%, rgba(255, 77, 0, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(255, 45, 45, 0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 80%, rgba(255, 138, 0, 0.05) 0%, transparent 50%);
      animation: fireGlow 8s ease-in-out infinite alternate;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes fireGlow {
      0% { transform: translate(0, 0) scale(1); }
      100% { transform: translate(-2%, -1%) scale(1.05); }
    }

    /* NOISE TEXTURE */
    body::after {
      content: '';
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 560px;
      margin: 0 auto;
      padding: 40px 20px 60px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* HEADER */
    .logo-link {
      text-decoration: none;
      cursor: pointer;
    }

    .logo {
      font-size: 3.2rem;
      font-weight: 900;
      text-align: center;
      line-height: 1;
      margin-bottom: 4px;
      letter-spacing: -2px;
      background: linear-gradient(135deg, var(--fire), var(--ember), var(--lava));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: logoIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .tagline {
      font-family: 'Space Mono', monospace;
      font-size: 0.82rem;
      color: var(--cool);
      text-align: center;
      margin-bottom: 40px;
      opacity: 0;
      animation: fadeUp 0.6s 0.2s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    @keyframes logoIn {
      from { opacity: 0; transform: scale(0.8) translateY(20px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* UPLOAD AREA */
    .upload-zone {
      width: 100%;
      border: 2px dashed rgba(255, 77, 0, 0.3);
      border-radius: 20px;
      padding: 50px 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: rgba(255, 77, 0, 0.03);
      position: relative;
      overflow: hidden;
      opacity: 0;
      animation: fadeUp 0.6s 0.35s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .upload-zone:hover {
      border-color: var(--fire);
      background: rgba(255, 77, 0, 0.06);
      transform: translateY(-2px);
    }

    .upload-zone.dragover {
      border-color: var(--ember);
      background: rgba(255, 138, 0, 0.1);
      transform: scale(1.02);
    }

    .upload-zone.has-image {
      padding: 16px;
      border-color: var(--fire);
    }

    .upload-icon {
      font-size: 4rem;
      margin-bottom: 12px;
      display: block;
      filter: grayscale(0.3);
    }

    .upload-text {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--ice);
      margin-bottom: 6px;
    }

    .upload-subtext {
      font-family: 'Space Mono', monospace;
      font-size: 0.72rem;
      color: var(--cool);
    }

    .upload-zone input[type="file"] {
      display: none;
    }

    .preview-img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 12px;
      object-fit: cover;
    }

    .change-photo {
      display: inline-block;
      margin-top: 10px;
      font-family: 'Space Mono', monospace;
      font-size: 0.72rem;
      color: var(--cool);
      cursor: pointer;
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    /* ROAST BUTTON */
    .roast-btn {
      width: 100%;
      margin-top: 20px;
      padding: 18px 32px;
      font-family: 'Outfit', sans-serif;
      font-size: 1.2rem;
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: white;
      background: linear-gradient(135deg, var(--fire), var(--lava));
      border: none;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      opacity: 0;
      animation: fadeUp 0.6s 0.5s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .roast-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--ember), var(--fire));
      opacity: 0;
      transition: opacity 0.3s;
    }

    .roast-btn:hover::before { opacity: 1; }
    .roast-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(255, 77, 0, 0.3); }
    .roast-btn:active { transform: translateY(0); }
    .roast-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .roast-btn span { position: relative; z-index: 1; }

    /* LOADING STATE */
    .loading-state {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      margin-top: 40px;
      width: 100%;
    }

    .loading-state.active { display: flex; }

    .flame-loader {
      font-size: 3rem;
      animation: flamePulse 0.6s ease-in-out infinite alternate;
    }

    @keyframes flamePulse {
      from { transform: scale(1) rotate(-5deg); filter: brightness(1); }
      to { transform: scale(1.15) rotate(5deg); filter: brightness(1.3); }
    }

    .loading-text {
      font-family: 'Space Mono', monospace;
      font-size: 0.85rem;
      color: var(--ember);
    }

    .loading-texts {
      text-align: center;
    }

    /* RESULT CARD */
    .result-card {
      display: none;
      width: 100%;
      margin-top: 30px;
      animation: cardIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .result-card.active { display: block; }

    @keyframes cardIn {
      from { opacity: 0; transform: translateY(40px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .card-inner {
      background: linear-gradient(180deg, var(--smoke) 0%, var(--ash) 100%);
      border: 1px solid rgba(255, 77, 0, 0.15);
      border-radius: 24px;
      padding: 32px 28px;
      position: relative;
      overflow: hidden;
    }

    .card-inner::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--fire), var(--ember), var(--lava), var(--fire));
      background-size: 200% 100%;
      animation: shimmer 3s linear infinite;
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .card-brand {
      font-family: 'Space Mono', monospace;
      font-size: 0.7rem;
      color: var(--cool);
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    /* PERSONALITY BADGE */
    .personality-container {
      display: flex;
      justify-content: center;
      margin-bottom: 24px;
    }

    .personality-badge {
      display: inline-block;
      padding: 12px 24px;
      background: rgba(255, 77, 0, 0.1);
      border: 1px solid rgba(255, 77, 0, 0.25);
      border-radius: 100px;
      font-family: 'Space Mono', monospace;
      font-size: 0.9rem;
      color: var(--ember);
      text-align: center;
    }

    /* ROAST TEXT */
    .roast-text {
      font-size: 1.15rem;
      line-height: 1.65;
      color: var(--ice);
      margin-bottom: 24px;
      padding-bottom: 24px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .roast-text::before {
      content: '"';
      font-size: 3rem;
      font-weight: 900;
      color: var(--fire);
      line-height: 0;
      vertical-align: -0.5em;
      margin-right: 4px;
    }

    .dating-forecast {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 16px;
      background: rgba(255, 138, 0, 0.06);
      border-radius: 12px;
      border: 1px solid rgba(255, 138, 0, 0.15);
    }

    .dating-icon { font-size: 1.3rem; flex-shrink: 0; margin-top: 1px; }

    .dating-label {
      font-family: 'Space Mono', monospace;
      font-size: 0.65rem;
      color: var(--ember);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 4px;
    }

    .dating-text {
      font-size: 0.92rem;
      color: var(--cool);
      line-height: 1.5;
    }

    /* SHARE BUTTONS */
    .share-section {
      margin-top: 24px;
      text-align: center;
    }

    .share-label {
      font-family: 'Space Mono', monospace;
      font-size: 0.7rem;
      color: var(--cool);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 14px;
    }

    .share-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .share-btn {
      padding: 12px 20px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.04);
      color: var(--ice);
      font-family: 'Space Mono', monospace;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .share-btn:hover {
      background: rgba(255, 77, 0, 0.1);
      border-color: rgba(255, 77, 0, 0.3);
      transform: translateY(-1px);
    }

    .try-again-btn {
      margin-top: 20px;
      padding: 16px 28px;
      background: linear-gradient(135deg, var(--fire), var(--lava));
      border: none;
      border-radius: 14px;
      color: white;
      font-family: 'Outfit', sans-serif;
      font-size: 1.1rem;
      font-weight: 800;
      letter-spacing: 0.5px;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
    }

    .try-again-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 32px rgba(255, 77, 0, 0.3);
    }

    /* COUNTER */
    .counter {
      margin-top: 40px;
      text-align: center;
      font-family: 'Space Mono', monospace;
      font-size: 0.72rem;
      color: rgba(255, 255, 255, 0.2);
      opacity: 0;
      animation: fadeUp 0.6s 0.7s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .counter span { color: var(--fire); font-weight: 700; }

    /* FOOTER */
    .footer {
      margin-top: auto;
      padding-top: 40px;
      text-align: center;
      font-family: 'Space Mono', monospace;
      font-size: 0.68rem;
      color: rgba(255, 255, 255, 0.15);
    }

    .footer a { color: rgba(255, 77, 0, 0.4); text-decoration: none; }

    /* RESPONSIVE */
    @media (max-width: 480px) {
      .logo { font-size: 2.4rem; }
      .card-inner { padding: 24px 20px; }
      .roast-text { font-size: 1.05rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="/" class="logo-link" id="logoLink"><h1 class="logo">ROAST MY FRIDGE</h1></a>
    <p class="tagline">Upload your fridge. Get destroyed by AI.</p>

    <div class="upload-zone" id="uploadZone">
      <span class="upload-icon">üßä</span>
      <p class="upload-text">Drop your fridge photo here</p>
      <p class="upload-subtext">or anything else you dare ¬∑ selfies ¬∑ closets ¬∑ desks ¬∑ pets</p>
      <input type="file" id="fileInput" accept="image/*">
    </div>

    <button class="roast-btn" id="roastBtn" disabled>
      <span>üî• ROAST MY FRIDGE üî•</span>
    </button>

    <div class="loading-state" id="loadingState">
      <div class="flame-loader">üî•</div>
      <div class="loading-texts">
        <p class="loading-text" id="loadingText">Judging your life choices...</p>
      </div>
    </div>

    <div class="result-card" id="resultCard">
      <div class="card-inner">
        <div class="card-header">
          <span class="card-brand">Roast My Fridge</span>
          <span class="card-brand">üî•</span>
        </div>

        <div class="personality-container">
          <div class="personality-badge" id="personalityBadge"></div>
        </div>

        <div class="roast-text" id="roastText"></div>

        <div class="dating-forecast" id="forecastSection">
          <span class="dating-icon" id="forecastIcon">üß†</span>
          <div>
            <div class="dating-label" id="forecastLabel">Forecast</div>
            <div class="dating-text" id="forecastText"></div>
          </div>
        </div>

        <div class="share-section">
          <p class="share-label">Share your shame</p>
          <div class="share-buttons">
            <a class="share-btn" id="shareTwitter" href="#" target="_blank">ùïè Post</a>
            <button class="share-btn" id="shareCopy">üìã Copy</button>
            <button class="share-btn" id="shareNative">üì§ Share</button>
          </div>
        </div>
      </div>

      <button class="try-again-btn" id="tryAgainBtn">üî• Roast Something Else üî•</button>
    </div>

    <div class="counter" id="counter">
      <span id="roastCount">0</span> fridges roasted and counting
    </div>

    <div class="footer">
      powered by artificial savagery ¬∑ <a href="https://roastmyfridge.lol">roastmyfridge.lol</a>
    </div>
  </div>

  <script>
    // State
    let imageData = null;
    let imageMediaType = null;
    let currentResult = null;

    // Elements
    const uploadZone = document.getElementById('uploadZone');
    const fileInput = document.getElementById('fileInput');
    const roastBtn = document.getElementById('roastBtn');
    const loadingState = document.getElementById('loadingState');
    const loadingText = document.getElementById('loadingText');
    const resultCard = document.getElementById('resultCard');

    // Loading messages
    const loadingMessages = [
      "Judging your life choices...",
      "Analyzing every detail...",
      "This is worse than expected...",
      "Consulting the roast gods...",
      "Measuring sadness levels...",
      "Evaluating your adulting skills...",
      "Oh... oh no...",
      "Writing your psychological profile...",
      "Finding the perfect insult...",
      "Your FBI agent is taking notes...",
    ];

    // Fake counter (start from a fun number, persist in session)
    let roastCount = parseInt(sessionStorage.getItem('roastCount')) || 14847;
    document.getElementById('roastCount').textContent = roastCount.toLocaleString();

    // Logo click ‚Äî reset to home
    document.getElementById('logoLink').addEventListener('click', (e) => {
      e.preventDefault();
      resultCard.classList.remove('active');
      loadingState.classList.remove('active');
      roastBtn.style.display = 'block';
      roastBtn.disabled = true;
      imageData = null;
      uploadZone.classList.remove('has-image');
      uploadZone.innerHTML = `
        <span class="upload-icon">üßä</span>
        <p class="upload-text">Drop your fridge photo here</p>
        <p class="upload-subtext">or anything else you dare ¬∑ selfies ¬∑ closets ¬∑ desks ¬∑ pets</p>
        <input type="file" id="fileInput" accept="image/*" style="display:none">
      `;
      const newInput = uploadZone.querySelector('input[type="file"]');
      uploadZone.addEventListener('click', () => newInput.click());
      newInput.addEventListener('change', (ev) => {
        const f = ev.target.files[0];
        if (f) handleFile(f);
      });
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Upload handlers
    uploadZone.addEventListener('click', () => fileInput.click());

    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('dragover');
    });

    uploadZone.addEventListener('dragleave', () => {
      uploadZone.classList.remove('dragover');
    });

    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('image/')) {
        handleFile(file);
      }
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) handleFile(file);
    });

    function handleFile(file) {
      // Show loading state while processing
      uploadZone.classList.add('has-image');
      uploadZone.innerHTML = '<p class="upload-text">Processing photo...</p>';

      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          // Resize to max 600px on longest side (faster upload, still detailed enough)
          const MAX = 600;
          let w = img.width, h = img.height;
          if (w > h) { if (w > MAX) { h = h * MAX / w; w = MAX; } }
          else { if (h > MAX) { w = w * MAX / h; h = MAX; } }

          const canvas = document.createElement('canvas');
          canvas.width = w;
          canvas.height = h;
          canvas.getContext('2d').drawImage(img, 0, 0, w, h);

          const compressed = canvas.toDataURL('image/jpeg', 0.6);
          imageData = compressed.split(',')[1];
          imageMediaType = 'image/jpeg';

          // Show preview
          uploadZone.innerHTML = `
            <img src="${compressed}" class="preview-img" alt="Your upload">
            <span class="change-photo">tap to change photo</span>
            <input type="file" id="fileInput" accept="image/*" style="display:none">
          `;

          const newInput = uploadZone.querySelector('input[type="file"]');
          uploadZone.addEventListener('click', () => newInput.click());
          newInput.addEventListener('change', (ev) => {
            const f = ev.target.files[0];
            if (f) handleFile(f);
          });

          roastBtn.disabled = false;
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    // Roast!
    roastBtn.addEventListener('click', async () => {
      if (!imageData) return;

      // Show loading
      roastBtn.style.display = 'none';
      resultCard.classList.remove('active');
      loadingState.classList.add('active');

      // Cycle loading messages
      let msgIndex = 0;
      const msgInterval = setInterval(() => {
        msgIndex = (msgIndex + 1) % loadingMessages.length;
        loadingText.textContent = loadingMessages[msgIndex];
      }, 2000);

      try {
        const res = await fetch('/api/roast', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            image: imageData,
            mediaType: imageMediaType,
          }),
        });

        if (!res.ok) throw new Error('Roast failed');

        const data = await res.json();
        if (data.error) throw new Error(data.error);

        currentResult = data;
        displayResult(data);

        // Update counter
        roastCount += 1;
        sessionStorage.setItem('roastCount', roastCount);
        document.getElementById('roastCount').textContent = roastCount.toLocaleString();
      } catch (err) {
        alert('The roast machine broke! Please try again. üî•');
        console.error(err);
        roastBtn.style.display = 'block';
      } finally {
        clearInterval(msgInterval);
        loadingState.classList.remove('active');
      }
    });

    function displayResult(data) {
      document.getElementById('personalityBadge').textContent = data.personality || 'Certified Disaster';
      document.getElementById('roastText').innerHTML = (data.roast || 'Your upload is beyond words.');

      // Dynamic forecast
      document.getElementById('forecastIcon').textContent = data.forecast_icon || 'üîÆ';
      document.getElementById('forecastLabel').textContent = data.forecast_label || 'Forecast';
      document.getElementById('forecastText').textContent = data.forecast || 'No comment.';

      resultCard.classList.add('active');
      resultCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Share functions
    function getShareText() {
      if (!currentResult) return '';
      return `AI roasted my ${(currentResult.subject || 'fridge').toLowerCase()} and called me "${currentResult.personality}" üíÄüî•\n\n${currentResult.roast}\n\nGet roasted ‚Üí ${window.location.href}`;
    }

    document.getElementById('shareTwitter').addEventListener('click', (e) => {
      e.preventDefault();
      const text = `AI roasted my ${(currentResult?.subject || 'fridge').toLowerCase()} and called me "${currentResult?.personality || ''}" üíÄüî•\n\nGet roasted ‚Üí`;
      const url = window.location.href;
      window.open(
        `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
        '_blank'
      );
    });

    document.getElementById('shareCopy').addEventListener('click', async () => {
      const text = getShareText();
      try {
        await navigator.clipboard.writeText(text);
        const btn = document.getElementById('shareCopy');
        btn.textContent = '‚úÖ Copied!';
        setTimeout(() => btn.textContent = 'üìã Copy', 2000);
      } catch {
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
      }
    });

    document.getElementById('shareNative').addEventListener('click', async () => {
      if (navigator.share) {
        try {
          await navigator.share({
            title: 'Roast My Fridge üî•',
            text: getShareText(),
            url: window.location.href,
          });
        } catch {}
      } else {
        // Fallback to copy
        document.getElementById('shareCopy').click();
      }
    });

    // Try again
    document.getElementById('tryAgainBtn').addEventListener('click', () => {
      resultCard.classList.remove('active');
      roastBtn.style.display = 'block';
      roastBtn.disabled = true;
      imageData = null;
      uploadZone.classList.remove('has-image');
      uploadZone.innerHTML = `
        <span class="upload-icon">üßä</span>
        <p class="upload-text">Drop your fridge photo here</p>
        <p class="upload-subtext">or anything else you dare ¬∑ selfies ¬∑ closets ¬∑ desks ¬∑ pets</p>
        <input type="file" id="fileInput" accept="image/*" style="display:none">
      `;
      const newInput = uploadZone.querySelector('input[type="file"]');
      uploadZone.addEventListener('click', () => newInput.click());
      newInput.addEventListener('change', (ev) => {
        const f = ev.target.files[0];
        if (f) handleFile(f);
      });
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  </script>
</body>
</html>
